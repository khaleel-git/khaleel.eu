<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grand Quiz: Explainable ML (Ex 1 & 2)</title>
    <style>
        :root {
            --primary: #2563eb;
            --success: #16a34a;
            --error: #dc2626;
            --bg: #f8fafc;
            --card: #ffffff;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background-color: var(--bg);
            color: #1e293b;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: var(--primary);
            color: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .stats-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-weight: bold;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .question-card {
            background: var(--card);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            display: none; /* Hidden by default */
        }

        .question-card.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .topic-tag {
            background: #e0f2fe;
            color: #0369a1;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: 600;
            margin-bottom: 10px;
            display: inline-block;
        }

        .code-snippet {
            background: #1e293b;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            overflow-x: auto;
            margin: 10px 0;
        }

        .options {
            display: grid;
            gap: 10px;
            margin-top: 20px;
        }

        .option-btn {
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            font-size: 1rem;
        }

        .option-btn:hover:not(:disabled) {
            border-color: var(--primary);
            background: #f0f9ff;
        }

        .option-btn.correct {
            background: #dcfce7;
            border-color: var(--success);
            color: #14532d;
        }

        .option-btn.wrong {
            background: #fee2e2;
            border-color: var(--error);
            color: #7f1d1d;
        }

        .explanation {
            margin-top: 20px;
            padding: 15px;
            background: #f0fdf4;
            border-left: 4px solid var(--success);
            display: none;
        }

        .next-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 20px;
            font-size: 1rem;
            float: right;
            display: none;
        }

        .next-btn:hover {
            background: #1d4ed8;
        }

        /* Results Screen */
        .results-container {
            text-align: center;
            display: none;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .score-circle {
            width: 150px;
            height: 150px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            margin: 0 auto 20px;
            font-weight: bold;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>Grand Quiz: Explainable ML</h1>
        <p>Covering Exercise 1 (Cardio) & Exercise 2 (Flight Delays)</p>
    </div>

    <div class="stats-bar" id="statsBar">
        <span>Question: <span id="currentQ">1</span>/20</span>
        <span>Score: <span id="currentScore">0</span></span>
    </div>

    <div id="quizContainer">
        <!-- Questions will be injected here by JS -->
    </div>

    <div id="results" class="results-container">
        <div class="score-circle" id="finalScore">0%</div>
        <h2>Quiz Completed!</h2>
        <p id="resultMessage"></p>
        <button class="next-btn" style="display:inline-block; float:none;" onclick="location.reload()">Restart Quiz</button>
    </div>

<script>
const questions = [
    // --- EXERCISE 1 (Cardio/Intro) ---
    {
        topic: "Ex 1: Preprocessing",
        question: "In the Cardio dataset, age is given in 'days'. Which code correctly converts it to years?",
        code: "df['age_years'] = ...?",
        options: [
            "df['age'] * 365",
            "df['age'] / 365",
            "df['age'] - 365",
            "np.log(df['age'])"
        ],
        correct: 1,
        explanation: "Since the age is in days, you must divide by 365 to approximate the age in years."
    },
    {
        topic: "Ex 1: Scaling",
        question: "What is the primary purpose of `StandardScaler` used in Exercise 1?",
        options: [
            "To convert text data into numbers",
            "To remove all missing values",
            "To transform data so it has Mean=0 and Variance=1",
            "To increase the size of the training set"
        ],
        correct: 2,
        explanation: "`StandardScaler` standardizes features by removing the mean and scaling to unit variance. This helps algorithms like Logistic Regression converge faster."
    },
    {
        topic: "Ex 1: Theory",
        question: "Which of the following best describes 'Interpretability'?",
        options: [
            "Using a second model to explain a black box",
            "A passive property of a model that allows humans to understand its cause and effect",
            "The accuracy of the model on test data",
            "Generating counterfactual examples"
        ],
        correct: 1,
        explanation: "Interpretability is an intrinsic property (e.g., a small Decision Tree is interpretable by design). Explainability usually refers to active, post-hoc methods applied to complex models."
    },
    {
        topic: "Ex 1: Models",
        question: "You trained a `LogisticRegression` model. How can you determine which feature was most important?",
        options: [
            "Check the `.coef_` (coefficients) attribute",
            "Check the accuracy score",
            "Count the number of rows in the dataset",
            "Logistic Regression cannot show feature importance"
        ],
        correct: 0,
        explanation: "In linear models like Logistic Regression, the magnitude (absolute value) of the coefficients (`.coef_`) indicates the importance of the feature."
    },
    {
        topic: "Ex 1: Pandas",
        question: "Which command is used to split your data into Training and Testing sets?",
        options: [
            "pd.split_data(df)",
            "train_test_split(X, y, test_size=0.2)",
            "df.groupby('train')",
            "np.random.split(df)"
        ],
        correct: 1,
        explanation: "`train_test_split` from `sklearn.model_selection` is the standard function for creating training and validation sets."
    },

    // --- EXERCISE 2 (Flight Delays) ---
    {
        topic: "Ex 2: Problem Definition",
        question: "In Exercise 2, we predicted `ARR_DELAY` (minutes). What type of ML problem is this?",
        options: [
            "Classification",
            "Clustering",
            "Regression",
            "Reinforcement Learning"
        ],
        correct: 2,
        explanation: "Predicting a continuous number (like minutes of delay) is a Regression problem. Predicting Yes/No would be Classification."
    },
    {
        topic: "Ex 2: Data Leakage",
        question: "When creating the feature matrix `X`, why did we execute `X = df.drop(columns=['ARR_DELAY'])`?",
        options: [
            "Because `ARR_DELAY` has too many missing values",
            "Because `ARR_DELAY` is the target variable (the answer)",
            "Because `ARR_DELAY` is a string variable",
            "To save memory"
        ],
        correct: 1,
        explanation: "If you include the target (`ARR_DELAY`) in the input features (`X`), the model will simply 'read' the answer, resulting in Data Leakage and a fake 100% accuracy."
    },
    {
        topic: "Ex 2: Metrics (Regression)",
        question: "Which metric is appropriate for evaluating the Flight Delay Regression model?",
        options: [
            "Accuracy",
            "RMSE (Root Mean Squared Error)",
            "F1-Score",
            "Confusion Matrix"
        ],
        correct: 1,
        explanation: "Accuracy and F1 are for classification. For regression (predicting numbers), we measure error distance using metrics like MSE, RMSE, or R²."
    },
    {
        topic: "Ex 2: Correlation",
        question: "You found that `DEP_DELAY` has a correlation of 0.94 with `ARR_DELAY`. What does this mean?",
        options: [
            "There is a very weak relationship",
            "As Departure Delay increases, Arrival Delay decreases",
            "There is a very strong positive linear relationship",
            "The data is normally distributed"
        ],
        correct: 2,
        explanation: "A Pearson correlation close to +1.0 indicates a strong positive linear relationship. If the plane leaves late, it arrives late."
    },
    {
        topic: "Ex 2: Metrics (Classification)",
        question: "In the Confusion Matrix, what does a 'False Negative' (FN) mean for delay prediction?",
        options: [
            "Model predicted 'Delayed', and it was Delayed",
            "Model predicted 'On Time', but it was actually Delayed",
            "Model predicted 'Delayed', but it was actually On Time",
            "Model predicted 'On Time', and it was On Time"
        ],
        correct: 1,
        explanation: "False Negative means the model missed the event. It predicted Negative (On Time), but the truth was Positive (Delayed). This is often the most costly error."
    },
    {
        topic: "Ex 2: Data Cleaning",
        question: "Why did we use `df.dropna(subset=['ARR_DELAY'])`?",
        options: [
            "To remove features that are not useful",
            "To remove rows where the Target value is missing",
            "To normalize the distribution",
            "To convert the date column"
        ],
        correct: 1,
        explanation: "Supervised learning requires labeled data. If the target (`ARR_DELAY`) is NaN, we cannot use that row for training or testing."
    },
    {
        topic: "Ex 2: Models",
        question: "Which model was used to capture non-linear relationships in Exercise 2?",
        options: [
            "Linear Regression",
            "Logistic Regression",
            "Decision Tree Regressor",
            "StandardScaler"
        ],
        correct: 2,
        explanation: "Decision Trees can model non-linear relationships and complex rules, unlike Linear Regression which fits a straight line."
    },
    {
        topic: "Theory: Transparency",
        question: "Which of the following is NOT a type of Transparency in XAI?",
        options: [
            "Simulatability",
            "Decomposability",
            "Algorithmic Transparency",
            "Accuracy Transparency"
        ],
        correct: 3,
        explanation: "The three standard types of transparency are Simulatability (can a human run it?), Decomposability (can we understand parts?), and Algorithmic Transparency. Accuracy is a performance metric, not a transparency type."
    },
    {
        topic: "Python Basics",
        question: "Based on the Python Tutorial, which library is primarily used for plotting graphs?",
        options: [
            "NumPy",
            "Pandas",
            "Matplotlib / Seaborn",
            "Scikit-learn"
        ],
        correct: 2,
        explanation: "Matplotlib (and Seaborn built on top of it) is the standard library for data visualization in Python."
    },
    {
        topic: "Ex 2: Evaluation",
        question: "What does an R² score of 0.95 indicate?",
        options: [
            "The model explains 95% of the variance in the target",
            "The model is 95% accurate",
            "The model has a 95% error rate",
            "The model is overfitting"
        ],
        correct: 0,
        explanation: "R² (Coefficient of Determination) measures the proportion of variance in the dependent variable that is predictable from the independent variables."
    }
];

let currentQIndex = 0;
let score = 0;

const container = document.getElementById('quizContainer');
const statsBar = document.getElementById('statsBar');
const resultsDiv = document.getElementById('results');

function loadQuiz() {
    questions.forEach((q, index) => {
        const card = document.createElement('div');
        card.className = `question-card ${index === 0 ? 'active' : ''}`;
        card.id = `q-${index}`;

        let codeBlock = q.code ? `<div class="code-snippet">${q.code}</div>` : '';

        let optionsHtml = q.options.map((opt, i) => 
            `<button class="option-btn" onclick="checkAnswer(${index}, ${i}, this)">${opt}</button>`
        ).join('');

        card.innerHTML = `
            <span class="topic-tag">${q.topic}</span>
            <h3>${q.question}</h3>
            ${codeBlock}
            <div class="options">${optionsHtml}</div>
            <div class="explanation" id="exp-${index}">
                <strong>Explanation:</strong> ${q.explanation}
            </div>
            <button class="next-btn" id="next-${index}" onclick="nextQuestion(${index})">
                ${index === questions.length - 1 ? 'Finish Quiz' : 'Next Question'}
            </button>
        `;
        container.appendChild(card);
    });
}

function checkAnswer(qIndex, optIndex, btn) {
    const q = questions[qIndex];
    const card = document.getElementById(`q-${qIndex}`);
    const allBtns = card.querySelectorAll('.option-btn');
    const explanation = document.getElementById(`exp-${qIndex}`);
    const nextBtn = document.getElementById(`next-${qIndex}`);

    // Disable all buttons
    allBtns.forEach(b => b.disabled = true);

    if (optIndex === q.correct) {
        btn.classList.add('correct');
        score++;
        document.getElementById('currentScore').innerText = score;
    } else {
        btn.classList.add('wrong');
        allBtns[q.correct].classList.add('correct');
    }

    explanation.style.display = 'block';
    nextBtn.style.display = 'inline-block';
}

function nextQuestion(index) {
    document.getElementById(`q-${index}`).classList.remove('active');
    
    if (index < questions.length - 1) {
        document.getElementById(`q-${index + 1}`).classList.add('active');
        currentQIndex++;
        document.getElementById('currentQ').innerText = currentQIndex + 1;
    } else {
        showResults();
    }
}

function showResults() {
    statsBar.style.display = 'none';
    container.style.display = 'none';
    resultsDiv.style.display = 'block';
    
    const percentage = Math.round((score / questions.length) * 100);
    document.getElementById('finalScore').innerText = `${percentage}%`;
    
    let msg = "";
    if (percentage >= 70) msg = "Great job! You passed the Core Problems threshold (70%).";
    else msg = "Keep practicing! You need 70% to pass the Core Problems.";
    
    document.getElementById('resultMessage').innerText = msg;
}

// Initialize
loadQuiz();

</script>
</body>
</html>